<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å–¶æ¥­ã‚µãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ</title>
  <style>
    body { font-family: sans-serif; margin: 16px; background-color: #f4f7f6; color: #333; }
    .card { background: #fff; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    label { display: block; margin: 12px 0 6px; font-weight: bold; font-size: 14px; }
    select, input, button { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 16px; }
    button { cursor: pointer; font-weight: 700; background-color: #005599; color: white; border: none; margin-top: 16px; }
    .result-box { display: none; border-left: 6px solid #e67e22; background: #fff9f5; }
    .hidden { display: none; }
    .highlight { color: #d32f2f; font-weight: bold; }
  </style>
</head>
<body>

  <div class="card" id="lockCard">
    <h3>ğŸ”’ ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰å…¥åŠ›</h3>
    <input id="passcode" type="password" placeholder="ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" />
    <button id="unlockBtn">ãƒ­ãƒƒã‚¯è§£é™¤</button>
    <p id="lockMsg" style="color:red; font-size:12px;"></p>
  </div>

  <div id="appBody" class="hidden">
    <h2 style="font-size: 1.1em; color: #005599;">OCNå…‰ IPoE å–¶æ¥­ææ¡ˆæ”¯æ´</h2>
    <div class="card">
      <label>â‘  ãƒ«ãƒ¼ã‚¿ãƒ¼ã®å‹ç•ªï¼ˆè‡ªå‰å“ï¼‰</label>
      <input type="text" id="routerModel" placeholder="ä¾‹: RTX830">
      <label>â‘¡ å›ºå®šIPã®å¿…è¦æ€§</label>
      <select id="needFixed">
        <option value="no">ä¸è¦ï¼ˆå‹•çš„IPï¼‰</option>
        <option value="yes">å¿…è¦ï¼ˆå›ºå®šIPï¼‰</option>
        <option value="unknown">ä¸æ˜</option>
      </select>
      <label>â‘¢ å›ç·šé€Ÿåº¦</label>
      <select id="lineSpeed">
        <option value="1g">1ã‚®ã‚¬ï¼ˆãƒã‚¯ã‚¹ãƒˆï¼‰</option>
        <option value="10g">10ã‚®ã‚¬ï¼ˆã‚¯ãƒ­ã‚¹ï¼‰</option>
      </select>
      <label>â‘£ Webä¼šè­°ã®é »åº¦</label>
      <select id="webMeeting">
        <option value="high">å¤šã„ï¼ˆTeams/Zoomç­‰ï¼‰</option>
        <option value="low">ç„¡ã—ãƒ»ã¾ãŸã¯å°‘ãªã„</option>
        <option value="unknown">é »åº¦ã¯åˆ†ã‹ã‚‰ãªã„</option>
      </select>
      <button id="judgeBtn">ææ¡ˆå†…å®¹ã‚’åˆ¤å®š</button>
    </div>

    <div class="card result-box" id="resultArea">
      <h3 style="margin-top:0; color: #e67e22;">ğŸ“‹ å–¶æ¥­ææ¡ˆã‚·ãƒ¼ãƒˆ</h3>
      <p id="resultText" style="line-height: 1.6;"></p>
      
      <hr style="border: 0; border-top: 1px dashed #ccc; margin: 16px 0;">
      <p id="luckyItem" style="font-size: 14px; color: #555; font-weight: bold;"></p>
      </div>
  </div>

<script>
let routerDB = [];

// ğŸ½ï¸ ãŠæ˜¼ã”é£¯ã®ææ¡ˆãƒªã‚¹ãƒˆï¼ˆã“ã“ã«è¿½åŠ ã—ã¾ã—ãŸï¼ï¼‰
const lunchList = [
  "ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³",
  "ğŸ² ã†ã©ã‚“",
  "ğŸ¥¢ ãã°",
  "ğŸ— å”æšã’å®šé£Ÿ",
  "ğŸ› ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹",
  "ğŸ¥ ãŠå¥½ã¿ç„¼ã",
  "ğŸ ã‚¤ã‚¿ãƒªã‚¢ãƒ³",
  "ğŸ± ã†ãªãï¼ˆè±ªè¯ï¼ï¼‰",
  "ğŸ™ ãŠã«ãã‚Š",
  "ğŸ« ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆï¼ˆè»½ã‚ã«...ï¼‰",
  "ğŸƒâ€â™‚ï¸ ãƒ€ã‚¤ã‚¨ãƒƒãƒˆï¼ï¼ˆæ°´ã§ã‚‚é£²ã‚‚ã†ï¼‰",
  "ğŸ” ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼",
  "ğŸ¥— ã‚³ãƒ³ãƒ“ãƒ‹ã®ã‚µãƒ©ãƒ€ãƒã‚­ãƒ³"
];

function getLunchSuggestion() {
  const i = Math.floor(Math.random() * lunchList.length);
  return lunchList[i];
}


// CSVã‚’èª­ã¿è¾¼ã‚€é–¢æ•°
async function loadCSV() {
    try {
        const response = await fetch('router_db.csv');
        const text = await response.text();
        const rows = text.split('\n').slice(1); // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é£›ã°ã™
        routerDB = rows.map(row => {
            const cols = row.split(',');
            if(cols.length < 2) return null;
            return {
                model: cols[0].trim(),
                normalized: cols[0].trim().toUpperCase().replace(/[^A-Z0-9]/g, ""),
                is10G: cols[1].trim() === "1"
            };
        }).filter(r => r !== null);
    } catch (e) {
        console.error("CSVèª­ã¿è¾¼ã¿å¤±æ•—", e);
    }
}

document.addEventListener("DOMContentLoaded", () => {
  loadCSV();
  const MY_PASSCODE = "test";

  document.getElementById("unlockBtn").addEventListener("click", () => {
    if (document.getElementById("passcode").value === MY_PASSCODE) {
      sessionStorage.setItem("nc_unlocked", "1");
      location.reload();
    } else {
      document.getElementById("lockMsg").innerHTML = "ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™<br>ãƒ’ãƒ³ãƒˆï¼šãƒ†ã‚¹ãƒˆ";
    }
  });

  if (sessionStorage.getItem("nc_unlocked") === "1") {
    document.getElementById("lockCard").classList.add("hidden");
    document.getElementById("appBody").classList.remove("hidden");
  }

document.getElementById("judgeBtn").addEventListener("click", () => {
    const rawInput = document.getElementById("routerModel").value;
    const fixedSelection = document.getElementById("needFixed").value;
    const speedSelection = document.getElementById("lineSpeed").value;
    const meetingFreq = document.getElementById("webMeeting").value;

    const normalizedInput = rawInput.toUpperCase().replace(/[^A-Z0-9]/g, "");
    
    // æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯
    const foundRouter = routerDB.find(r => {
        return normalizedInput.includes(r.normalized) || r.normalized.includes(normalizedInput);
    });
    
    let plan = (fixedSelection === "no") ? "BOCN IPoE æ¨™æº–ãƒ—ãƒ©ãƒ³ï¼ˆå‹•çš„IPï¼‰" : "BOCN IPoE å›ºå®šIPãƒ—ãƒ©ãƒ³ï¼ˆæ¨™æº–/ãƒ¯ã‚¤ãƒ‰ï¼‰";
    let routerInfo = "";

    if (speedSelection === "10g") {
      if (foundRouter && foundRouter.is10G) {
        routerInfo = `æ—¢å­˜ãƒ«ãƒ¼ã‚¿ãƒ¼(${foundRouter.model})ã¯10Gå¯¾å¿œã®ãŸã‚ã€ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½ã§ã™ã€‚`;
      } else {
        routerInfo = "<span class='highlight'>10G(ã‚¯ãƒ­ã‚¹)å¯¾å¿œã®IPoEãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’æ–°è¦è³¼å…¥ã„ãŸã ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span>";
      }
    } else {
      if (foundRouter) {
        routerInfo = `æ—¢å­˜ãƒ«ãƒ¼ã‚¿ãƒ¼(${foundRouter.model})ã¯IPoEå¯¾å¿œã®ãŸã‚ã€ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½ã§ã™ã€‚`;
      } else {
        if (fixedSelection === "no") {
          routerInfo = "<span class='highlight'>IPoEå¯¾å¿œãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’æ–°è¦è³¼å…¥ã„ãŸã ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span>";
        } else {
          routerInfo = "<span class='highlight'>ã€Œãƒ¬ãƒ³ã‚¿ãƒ«ãƒ«ãƒ¼ã‚¿ãƒ¼02ã€ã®ç”³è¾¼ã¿ã€ã¾ãŸã¯ã€ŒIPoEå¯¾å¿œãƒ«ãƒ¼ã‚¿ãƒ¼ã€ã‚’ã”è‡ªèº«ã§è³¼å…¥</span>ã„ãŸã ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚";
        }
      }
    }

    let optionInfo = (meetingFreq === "high") ? "ã€é‡è¦ã€‘Webä¼šè­°ãŒå¤šã„ãŸã‚ã€<strong>ã€Œã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«Aã€</strong>ã‚’ä½µã›ã¦ãŠã‚¹ã‚¹ãƒ¡ã—ã¦ãã ã•ã„ã€‚" : "å¿…è¦ã«å¿œã˜ã¦å¾Œæ—¥<strong>ã€Œã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«Aã€</strong>ã®è¿½åŠ ã‚‚å¯èƒ½ã§ã™ã€‚";

    document.getElementById("resultText").innerHTML = `<strong>ã€æ¨å¥¨ã€‘${plan}</strong><br><br><strong>â–  ãƒ«ãƒ¼ã‚¿ãƒ¼</strong><br>${routerInfo}<br><br><strong>â–  è£œè¶³</strong><br>${optionInfo}`;
    
    // â–¼â–¼â–¼ ã“ã“ã§ãŠæ˜¼ã”é£¯ã®çµæœã‚’è¡¨ç¤ºï¼ â–¼â–¼â–¼
    const luckyEl = document.getElementById("luckyItem");
    luckyEl.textContent = "ğŸ½ï¸ ãŠæ˜¼ã”é£¯ã«è¿·ã£ãŸã‚‰ãƒ»ãƒ»ãƒ» " + getLunchSuggestion();

    document.getElementById("resultArea").style.display = "block";
  });
});
</script>
</body>
</html>
